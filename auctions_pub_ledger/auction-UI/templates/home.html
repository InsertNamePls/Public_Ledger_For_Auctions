<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Auction House Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://netdna.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
        body {
            margin-top: 70px; /* Adjusted to ensure the navbar does not overlap content */
        }
        .table {
            border-collapse: separate;
        }
        .table-hover>tbody>tr:hover>td,
        .table-hover>tbody>tr:hover>th {
            background-color: #eee;
        }
        .table thead>tr>th {
            border-bottom: 1px solid #C2C2C2;
            padding-bottom: 0;
        }
        .table tbody>tr>td {
            font-size: 0.875em;
            background: #f5f5f5;
            border-top: 10px solid #fff;
            vertical-align: middle;
            padding: 12px 8px;
        }
        .table tbody>tr>td:first-child,
        .table thead>tr>th:first-child {
            padding-left: 20px;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Auction House</a>
            </div>
            <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Home</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main content area -->
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <!-- First column for Auction History -->
                <div class="main-box clearfix">
                    <h2>Auction History</h2>
                    <div class="table-responsive">
                        <table class="table table-hover" id="auctionHistoryTable">
                            <thead>
                                <tr>
                                    <th><span>Product Name</span></th>
                                    <th><span>Bid Price</span></th>
                                    <th><span>End Time</span></th>
                                    <th><span>Auction State</span></th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <!-- Second column for Following Items -->
                <div class="main-box clearfix">
                    <h2>Following Items</h2>
                    <div class="table-responsive">
                        <table class="table table-hover" id="followingItemsTable">
                            <thead>
                                <tr>
                                    <th><span>Product Name</span></th>
                                    <th><span>Bid Price</span></th>
                                    <th><span>End Time</span></th>
                                    <th><span>Auction State</span></th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- Full-width table for Open Auctions -->
        <div class="main-box clearfix">
            <h2>Open Auctions</h2>
            <div class="table-responsive">
                <table class="table table-hover" id="openAuctionsTable">
                    <thead>
                        <tr>
                            <th><span>Product Name</span></th>
                            <th><span>Bid Price</span></th>
                            <th><span>End Time</span></th>
                            <th><span>Auction State</span></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div> 
        </div>
    </div>
    

    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</body>
</html>


<script>
    $(document).ready(function() {
        function fetchAndDisplayAuctions() {
            $.getJSON('/api/auctions', function(data) {
                var auctions = data.auctions;
                var auctionHistoryHtml = '';
                var followingItemsHtml = '';
                var openAuctionsHtml = '';
    
                Object.keys(auctions).forEach(function(key) {
                    var auction = auctions[key];
                    var rowHtml = '<tr>' +
                        '<td>' + auction.item_name + '</td>' +
                        '<td>$' + (auction.bids.length > 0 ? auction.bids[auction.bids.length - 1].amount : auction.starting_bid) + '</td>' +
                        '<td>' + new Date(auction.end_time * 1000).toLocaleString() + '</td>' +
                        '<td>' + (auction.active ? 'Active' : 'Closed') + '</td>' +
                        '</tr>';
    
                    // Determine which table to populate
                    if (!auction.active) {
                        auctionHistoryHtml += rowHtml;  // Closed auctions go here
                    } else {
                        openAuctionsHtml += rowHtml;  // Active auctions go here
                        followingItemsHtml += rowHtml; // Assuming you want all active items in 'Following'
                    }
                });
    
                $('#auctionHistoryTable tbody').html(auctionHistoryHtml);
                $('#followingItemsTable tbody').html(followingItemsHtml);
                $('#openAuctionsTable tbody').html(openAuctionsHtml);
            });
        }
    
        fetchAndDisplayAuctions();
        setInterval(fetchAndDisplayAuctions, 30000); // Optional: Refresh data every 30 seconds
    });
    </script>
    